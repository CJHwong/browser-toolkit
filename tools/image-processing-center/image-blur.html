<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Blur Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }
      /* Custom focus rings for better accessibility and branding */
      .focus\:ring-indigo-500:focus {
        --tw-ring-color: #6366f1;
      }
    </style>
  </head>
  <body
    class="bg-slate-100 dark:bg-slate-900 text-slate-800 dark:text-slate-200 flex items-center justify-center min-h-screen p-4"
  >
    <div class="w-full max-w-4xl mx-auto">
      <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-6 md:p-8">
        <div class="text-center mb-8">
          <h1
            class="text-2xl md:text-3xl font-bold text-slate-900 dark:text-white"
          >
            Image Blur Tool
          </h1>
        </div>

        <!-- Controls -->
        <div class="bg-slate-50 dark:bg-slate-700/50 rounded-xl p-6 mb-6">
          <div
            class="flex flex-col md:flex-row md:items-center md:justify-between gap-6"
          >
            <div>
              <label
                for="imageInput"
                class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
                >Upload Image</label
              >
              <input
                type="file"
                id="imageInput"
                accept="image/*"
                class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 dark:file:bg-indigo-900/50 dark:file:text-indigo-300 dark:hover:file:bg-indigo-900"
              />
            </div>
            <div class="flex items-center gap-4">
              <label
                for="blurRange"
                class="text-sm font-medium text-slate-700 dark:text-slate-300"
                >Blur:</label
              >
              <input
                type="range"
                id="blurRange"
                min="0"
                max="20"
                value="0"
                step="0.5"
                class="w-48 h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer dark:bg-slate-700 accent-indigo-600"
              />
              <span
                id="blurValue"
                class="text-sm font-mono text-slate-600 dark:text-slate-400 w-16 text-center"
                >0 px</span
              >
            </div>
          </div>
        </div>

        <!-- Canvas & Actions -->
        <div class="flex flex-col lg:flex-row gap-6">
          <div
            class="w-full lg:w-2/3 bg-slate-200/50 dark:bg-slate-900/50 rounded-lg p-2 flex items-center justify-center"
          >
            <canvas
              id="canvas"
              class="max-w-full h-auto object-contain rounded-md"
            ></canvas>
          </div>
          <div class="w-full lg:w-1/3 flex flex-col justify-center gap-4">
            <button
              id="downloadBtn"
              disabled
              class="w-full flex items-center justify-center gap-2 bg-emerald-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-emerald-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 dark:focus:ring-offset-slate-800 disabled:bg-slate-400 dark:disabled:bg-slate-600 disabled:cursor-not-allowed"
            >
              Download
            </button>
            <button
              id="resetBtn"
              disabled
              class="w-full flex items-center justify-center gap-2 bg-slate-200 text-slate-700 font-semibold py-3 px-6 rounded-lg hover:bg-slate-300 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 dark:bg-slate-600 dark:text-slate-200 dark:hover:bg-slate-500 dark:focus:ring-offset-slate-800 disabled:bg-slate-400 dark:disabled:bg-slate-600 disabled:cursor-not-allowed"
            >
              Reset
            </button>
          </div>
        </div>
      </div>
      <footer class="text-center mt-4">
        <p class="text-sm text-slate-500 dark:text-slate-400">
          Adjust the slider to apply a blur effect.
        </p>
      </footer>
    </div>

    <script>
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      const imageInput = document.getElementById('imageInput');
      const blurRange = document.getElementById('blurRange');
      const blurValue = document.getElementById('blurValue');
      const downloadBtn = document.getElementById('downloadBtn');
      const resetBtn = document.getElementById('resetBtn');

      let originalImage = null;

      function applyBlurEffect() {
        if (!originalImage) return;

        // Use rAF for smoother rendering
        requestAnimationFrame(() => {
          blurValue.textContent = `${blurRange.value} px`;
          ctx.filter = `blur(${blurRange.value}px)`;
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.drawImage(originalImage, 0, 0);
        });
      }

      imageInput.addEventListener('change', e => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = event => {
            originalImage = new Image();
            originalImage.onload = () => {
              canvas.width = originalImage.width;
              canvas.height = originalImage.height;

              // Apply initial blur (which is 0)
              applyBlurEffect();

              downloadBtn.disabled = false;
              resetBtn.disabled = false;
            };
            originalImage.src = event.target.result;
          };
          reader.readAsDataURL(file);
        }
      });

      blurRange.addEventListener('input', applyBlurEffect);

      resetBtn.addEventListener('click', () => {
        if (originalImage) {
          blurRange.value = 0;
          applyBlurEffect();
        }
      });

      downloadBtn.addEventListener('click', () => {
        const link = document.createElement('a');
        link.download = 'blurred-image.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    </script>
  </body>
</html>
